---
title: 介质访问控制
date: 2025-07-16
icon: 'earth-americas'
order: 17
category: 
    - '408'
    - '计算机网络'
    - 考研
---

- **介质访问控制**

介质访问控制（Medium Access Control）简称 MAC ，多个节点共享同一个“总线型”广播信道时，可能发生“信号冲突”

为了解决信号冲突问题，才有了介质访问控制的概念

介质范围控制有三种类型：信道划分、随机访问、轮询访问

## 信道划分

### 时分复用（TDM）

时分复用（Time Division Multiplexing）简称 TDM —— 将时间分为**等长的“ TDM 帧”**，每个“ TDM 帧”又分为**等长的 $m$ 个“时隙”**，将 $m$ 个时隙分配个 $m$ 对用户（节点）使用

- **缺点**

    - 每个节点最多只能分配到信道总带宽的 $\frac{1}{m}$

    - 如果某个节点暂时不发送数据，会导致被分配的“时隙”闲置，信道利用率低

### 统计时分复用（STDM）

统计时分复用（Statistical Time Division Multiplexing）简称 STDM —— 又称异步时分复用，在 TDM 的基础上，动态按需分配时序

- **优点**

    - 如果需要时，一个节点可以在一段时间内获得所有的信道带宽资源

    - 如果某节点暂时不发送数据，可不分配“时隙”，信道利用率高

### 频分复用（FDM）

频分复用（Frequency Division Multiplexing）简称 FDM —— 是将信道的总频带划分为多个子频带，每个频带作为一个子信道，每对用户使用一个子信道进行通信

- **优点**

    - 各节点可同时发送信号；充分利用了信道带宽（Hz）

- **缺点**

    - FDM 技术只能用于模拟信号的传输

### 波分复用（WDM）

波分复用（Wave Division Multiplexing）简称 WDM —— 即光的频分复用，光信号的频带范围很大，很适合采用波分复用技术，将一根光纤在逻辑上拆分为多个子信道

### 码分复用（CDM）

```markmap
---
markmap:
    colorFreezeLevel: 3
    maxWidth: 400
---

# 码分复用

## 给各节点分配专属“码片序列”

### “码片序列”包含 m 个码片（信号值），可看作 **“m维向量”（m维向量的分量通常取1或-1）**

### 要求：各节点的“ m 维向量”**必须相互正交**

### tips：相互通信的各节点知道彼此的“码片序列”

## 发送方如何发送数据

### 节点发出 m 个信号值**与“码片序列”相同**，表示**比特1**

### 节点发出 m 个信号值**与“码片序列”相反**，表示**比特0**

## 信号在传输过程中的“叠加”

### 当多个发送方同时发送数据时，信号值会叠加（本质是多个m维向量的加法）

## 接收方如何接收数据

### 接收方收到的是“叠加”信号，需要从中“分离”出各发送方的数据

### **叠加信号**与**发送方的码片序列**作“规格化内积”

- **结果为 1 表示比特 1**

- **结果为 -1 表示比特 0**

```

假设有 A 、 B 、 C 三个基站

下面给三个基站分配其各自的码片序列

| 基站 | 码片序列 | 二进制 1 表示 | 二进制 0 表示 |
| :---: | :---: | :---: | :---: |
| A | $\vec{a} = (1, 1, 1,  1)$ | $\vec{a}$ | $-\vec{a}$ |
| B | $\vec{b} = (1, -1, 1, -1)$ | $\vec{b}$ | $-\vec{b}$ |
| C | $\vec{c} = (1, 1, -1, -1)$ | $\vec{c}$ | $-\vec{c}$ |

此时 C 站收到三个信号 $(1, 1, 1, 1), (-1, -1, -1, -1), (1, 1, 1, 1)$

由于每个站内都有保存各自的码片序列且码片序列的分量都是正交的（内积为 0 ），因此可以很容易的分辨出信号的来源

假设 C 站同时收到两个信号 $\vec{a} = (1, 1, 1, 1), -\vec{b} (-1, 1, -1, 1)$ ，它收到的信号应该是两者的叠加值即 $\vec{a} + (-\vec{b}) = (0, 2, 0, 2)$

为了分离出各自的信息需要先使用各个基站的码片对传输结果进行规格化内积

首先计算基站 A 

$$
\begin{aligned}


\text{基站 C 收到的信号与基站 A 码片序列的内积} &= \frac{1}{m} \cdot \vec{a} \cdot (\vec{a} + (-\vec{b})) \\

&= \frac{1}{m} \cdot \vec{a} \cdot \vec{a} \\

&= \frac{1}{4} \cdot 4 \\

&= 1

\end{aligned}
$$

根据规格化内积 1 即比特 1 、内积 -1 即比特 0

同样的可以得到基站 B 传来的信号进行规格化内积为 -1 即比特 0 

## 随机访问

### ALOHA 协议

发送方的发送数据准备好就马上发送数据、如果同时有两个数据发生冲突会导致两个数据都无法被正确接收，然后随机等待一段时间后再触发重传，在不断地试错下完成各个数据的发送

### 时隙 ALOHA 协议

和 ALOHA 协议相同但是它将时间划分为一个个“时隙”，节点可以在一个“时隙”内的任意时间确认发送数据，并且在下一个“时隙”发送数据，并且一个时隙内一定能发送完一个帧，如果发生冲突，节点会随机等待一段时间后再发送数据，在不断地试错下完成各个数据的发送

时隙 ALOHA 避免了用户发送数据的随意性，降低了冲突概率，提高了信道的利用率

### CSMA 协议

CSMA （Carrier Sense Multiple Access）协议，即**载波监听多路访问协议**

其在 ALOHA 协议的基础上进行改进：**在发送数据前，先监听信道是否空闲，只有信道空闲时，才会尝试发送**{#blue-msg}

各个节点会先安装**载波监听装置**监听信道

### 1-坚持 CSMA 协议

坚持代表在信道不空闲时是否坚持对信道进行监听

坚持监听的 CSMA 协议

![1-坚持 CSMA 协议流程图](https://store.s1r0ko.top/svg/m_cn_17_1_ver_1.svg)

- **优点**

信道利用率高，信道一旦空闲，就可以被下一个节点使用

- **缺点**

当多个节点同时准备好发送数据时，一旦信道空闲，会有多个节点同时发送数据，会造成发生冲突的概率大大增加

### 非坚持 CSMA 协议

为了解决 1-坚持 CSMA 协议的监听冲突问题，才有了非坚持 CSMA 协议

![非坚持 CSMA 协议流程图](https://store.s1r0ko.top/svg/m_cn_17_2_ver_1.svg)

- **优点**

当多个节点都准备好数据时，如果信道不空闲，则各节点会**随机推迟一段时间再尝试监听**，从而使**各节点“错开”发送数据**。降低冲突概率

- **缺点**

信道刚恢复空闲时，可能不会被立即利用，导致信道利用率低

### p-坚持 CSMA 协议

结合1-坚持和非坚持的优点改进而成的p-坚持协议

这里的 $p$ 指的是在信道空闲时，有多大的概率发送数据

![p-坚持 CSMA 协议流程图](https://store.s1r0ko.top/svg/m_cn_17_3_ver_2.svg)

- **优点**

属于 1-坚持 CSMA 、非坚持 CSMA 的折中方案，降低冲突概率的同时提升信道利用率

### :scream: **CSMA/CD 协议**{#red-msg}

常用于早期有线以太网[（总线型）](/art/learning/master/major/ComputerNetworks/ClassificationOfComputerNetworks.html#按拓扑结构分类)

```markmap
---
markmap:
    colorFreezeLevel: 4
    maxWidth: 400
---

# CSMA/CD 协议

## 协议要点

### 先听后发，边听边发，**冲突停发**，**随机重发**

### 如何随机重发

- [截断二进制指数退避算法](/art/learning/master/major/ComputerNetworks/MediaAccessControl.html#截断二进制指数退避算法)

### 特别注意

- 第 10 次冲突，是“随机重发”的分水岭

- 第 16 次冲突，直接躺平，放弃传帧，报告上级（网络层）

## $\text{争用期} = 2 \times \text{最大单向传播时延（考虑距离最远的两个节点）}$

### 若争用期内未发生冲突，就不可能再冲突

### CSMA/CD 没有 ACK 机制，若发送过程中未检测到冲突，就认为帧发送成功

## $\text{最短帧长} = 2 \times \text{最大单向传播时延} \times \text{信道带宽}$

### 若收到的帧小于最短帧长，则视为无效帧

## 最长帧长：规定最长帧长可防止某些节点一直占用信道

## 以太网规定

### 最短帧长：64B；最长帧长：1518B

```

![CSMA/CD 协议发送方流程图](https://store.s1r0ko.top/svg/m_cn_17_4_ver_1.svg)

这里的等待时间由[截断二进制指数退避算法](/art/learning/master/major/ComputerNetworks/MediaAccessControl.html#截断二进制指数退避算法)计算得出


## 补充内容

一些补充内容

### 截断二进制指数退避算法

$\text{随机等待一段时间} = r \text{倍争用期，其中} r \text{是随机数}$

- 如果 $k \le 10$，在 $[0, (2^k - 1)]$ 区间随机取一个整数 $r$

- 如果 $k > 10$，在 $[0, (2^{10} - 1)]$ 区间随机取一个整数 $r$